!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.logger=t():e.logger=t()}(global,function(){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(o(1)),i=r(o(2)),s=r(o(3));o(4);var l=function(){function e(e){this.logApplication="def",this.logLevel="silly",this.LogToConsole=!1,this.logToFile=!1,this.logFilePath="./logs",this.logHttp=!1,this.logMaxSize="5m",this.logMaxFiles="14d",this.$tmpLogger={},this.$logger={},this.$httpLogger=function(e,t,o){},"DEF"===e&&console.debug("AppLogger/constructor() No app name set, using defaults"),this.logApplication=e,this.logLevel=["debug","info","warn","error"].indexOf(process.env["ACE_"+e+"_LOG_LEVEL"]||"")>=0?process.env["ACE_"+e+"_LOG_LEVEL"]:"silly",this.LogToConsole="true"===process.env["ACE_"+e+"_LOG_CONSOLE"],this.logToFile="true"===process.env["ACE_"+e+"_LOG_FILE"],this.logFilePath=process.env["ACE_"+e+"_LOG_FILE_PATH"]||"./logs",this.logHttp="true"===process.env["ACE_"+e+"_LOG_HTTP"],this.logMaxSize=process.env["ACE_"+e+"_LOG_MAX_SIZE"]||"5m",this.logMaxFiles=process.env["ACE_"+e+"_LOG_MAX_FILES"]||"14d",n.default.existsSync(this.logFilePath)||n.default.mkdirSync(this.logFilePath),this.$logger=s.default.createLogger({level:this.logLevel,format:s.default.format.json()}),this.setTransports(),this.logHttp&&this.setHttpLogging()}return Object.defineProperty(e.prototype,"logger",{get:function(){return this.$logger},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"httpLogger",{get:function(){return this.$httpLogger},enumerable:!0,configurable:!0}),e.prototype.setTransports=function(){this.LogToConsole&&this.$logger.add(new s.default.transports.Console({format:s.default.format.simple()})),this.logToFile&&this.$logger.add(new s.default.transports.DailyRotateFile({filename:i.default.resolve(this.logFilePath,this.logApplication.toLowerCase()+"_%DATE%_"+this.logLevel+".log"),datePattern:"YYYY-MM-DD HH:mm",zippedArchive:!0,maxSize:this.logMaxSize,maxFiles:this.logMaxFiles,level:this.logLevel}))},e.prototype.setHttpLogging=function(){var e=this;this.$tmpLogger=s.default.createLogger({format:s.default.format.json(),transports:[new s.default.transports.DailyRotateFile({filename:i.default.resolve(this.logFilePath,this.logApplication.toLowerCase()+"_%DATE%_http.log"),datePattern:"YYYY-MM-DD HH:mm",zippedArchive:!0,maxSize:this.logMaxSize,maxFiles:this.logMaxFiles})]});var t=o(5),r=o(6);t.token("conversation-id",function(e){return e.conversationId}),t.token("session-id",function(e){return e.sessionId}),t.token("instance-id",function(e){return e.instanceId}),t.token("hostname",function(){return r.hostname()}),t.token("pid",function(){return process.pid}),this.$httpLogger=t(function(e,t,o){return JSON.stringify({"remote-address":e["remote-addr"](t,o),time:e.date(t,o,"iso"),method:e.method(t,o),url:e.url(t,o),"http-version":e["http-version"](t,o),"status-code":e.status(t,o),"content-length":e.res(t,o,"content-length"),referrer:e.referrer(t,o),"user-agent":e["user-agent"](t,o),"conversation-id":e["conversation-id"](t,o),"session-id":e["session-id"](t,o),hostname:e.hostname(t,o),instance:e["instance-id"](t,o),pid:e.pid(t,o)})},{stream:{write:function(t){var o=JSON.parse(t);e.$tmpLogger.info(o["status-code"]+" "+o.method+" "+o.url,o),e.LogToConsole&&console.log(o.time+" "+o["status-code"]+" "+o.method+" "+o.url)}}})},e}();t.default=l;var a=new l(global.APP||"DEF");t.Logger=a.logger,t.HttpLogger=a.httpLogger},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("winston-daily-rotate-file")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("os")}])});